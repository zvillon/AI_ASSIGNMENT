# Project 1: CNN Implementation from Scratch

This project contains a from-scratch implementation of a Convolutional Neural Network (CNN) in Java. The primary goal is to recognize handwritten digits from the MNIST dataset.

## Model Architecture

The model is a simple yet functional CNN architecture, composed of the following layers:

1.  **ConvolutionLayer**: Applies a set of filters (kernels) to extract features from the input image (e.g., edges, corners).
2.  **ReLU (Activation)**: A non-linear activation function to introduce complexity.
3.  **MaxPoolingLayer**: Downsamples the feature maps to make the model more efficient and robust to variations in feature location.
4.  **Flatten**: Flattens the 3D output of the convolutional block into a 1D vector.
5.  **DenseLayer (Fully Connected)**: One or more dense layers for the final classification.
6.  **Sigmoid (Activation)**: Used on the output layer to produce probabilities.

The model was designed to demonstrate an understanding of the internal mechanisms of a CNN, including the forward pass and the backpropagation of error.

## How to Run

The project is a standard Java application.

1.  **Compilation:**

    - The project can be compiled using a build tool like Maven with the provided `pom.xml`.
    - Alternatively, the `.java` files can be compiled manually using `javac`.
    - javac -d classes src/main/java/com/cnn/*.java
    - java -cp classes MNISTTraining

2.  **Data:**

    - The program automatically looks for the MNIST data files (`train-images-idx3-ubyte`, `train-labels-idx1-ubyte`) or a `train.csv` file in the root directory.
    - If no data is found, simulated data will be generated to allow the program to run.

3.  **Execution:**
    - Run the `MNISTTraining` class to start the training and evaluation of the model.

## Results

The model is capable of achieving significant accuracy on the MNIST test set after several epochs of training. Performance depends on the chosen hyperparameters (learning rate, number of epochs, architecture).

This project provided hands-on experience with the fundamental concepts of convolution, pooling, and backpropagation in a computer vision context.

## Result of the calculation

```
=== MNIST Training with CNN ===
üîç Looking for MNIST data...
‚ö†Ô∏è Using simulated MNIST data for demonstration.
‚ö†Ô∏è Using simulated MNIST data for demonstration.
‚úÖ Loaded data: 3000 training images, 200 test images
üöÄ Starting training phase...
  Epoch 1: 500/3000 samples processed...
  Epoch 1: 1000/3000 samples processed...
  Epoch 1: 1500/3000 samples processed...
  Epoch 1: 2000/3000 samples processed...
  Epoch 1: 2500/3000 samples processed...
  Epoch 1: 3000/3000 samples processed...
‚úì Epoch 1/20, Average Error: 0.331827, Training Accuracy: 10.83%
  Epoch 2: 500/3000 samples processed...
  Epoch 2: 1000/3000 samples processed...
  Epoch 2: 1500/3000 samples processed...
  Epoch 2: 2000/3000 samples processed...
  Epoch 2: 2500/3000 samples processed...
  Epoch 2: 3000/3000 samples processed...
‚úì Epoch 2/20, Average Error: 0.327117, Training Accuracy: 11.07%
  Epoch 3: 500/3000 samples processed...
  Epoch 3: 1000/3000 samples processed...
  Epoch 3: 1500/3000 samples processed...
  Epoch 3: 2000/3000 samples processed...
  Epoch 3: 2500/3000 samples processed...
  Epoch 3: 3000/3000 samples processed...
‚úì Epoch 3/20, Average Error: 0.326698, Training Accuracy: 10.53%
  Epoch 4: 500/3000 samples processed...
  Epoch 4: 1000/3000 samples processed...
  Epoch 4: 1500/3000 samples processed...
  Epoch 4: 2000/3000 samples processed...
  Epoch 4: 2500/3000 samples processed...
  Epoch 4: 3000/3000 samples processed...
‚úì Epoch 4/20, Average Error: 0.326232, Training Accuracy: 9.67%
  Epoch 5: 500/3000 samples processed...
  Epoch 5: 1000/3000 samples processed...
  Epoch 5: 1500/3000 samples processed...
  Epoch 5: 2000/3000 samples processed...
  Epoch 5: 2500/3000 samples processed...
  Epoch 5: 3000/3000 samples processed...
‚úì Epoch 5/20, Average Error: 0.325788, Training Accuracy: 10.40%
  Epoch 6: 500/3000 samples processed...
  Epoch 6: 1000/3000 samples processed...
  Epoch 6: 1500/3000 samples processed...
  Epoch 6: 2000/3000 samples processed...
  Epoch 6: 2500/3000 samples processed...
  Epoch 6: 3000/3000 samples processed...
‚úì Epoch 6/20, Average Error: 0.325373, Training Accuracy: 10.70%
  Epoch 7: 500/3000 samples processed...
  Epoch 7: 1000/3000 samples processed...
  Epoch 7: 1500/3000 samples processed...
  Epoch 7: 2000/3000 samples processed...
  Epoch 7: 2500/3000 samples processed...
  Epoch 7: 3000/3000 samples processed...
‚úì Epoch 7/20, Average Error: 0.323922, Training Accuracy: 13.07%
  Epoch 8: 500/3000 samples processed...
  Epoch 8: 1000/3000 samples processed...
  Epoch 8: 1500/3000 samples processed...
  Epoch 8: 2000/3000 samples processed...
  Epoch 8: 2500/3000 samples processed...
  Epoch 8: 3000/3000 samples processed...
‚úì Epoch 8/20, Average Error: 0.322026, Training Accuracy: 14.57%
  Epoch 9: 500/3000 samples processed...
  Epoch 9: 1000/3000 samples processed...
  Epoch 9: 1500/3000 samples processed...
  Epoch 9: 2000/3000 samples processed...
  Epoch 9: 2500/3000 samples processed...
  Epoch 9: 3000/3000 samples processed...
‚úì Epoch 9/20, Average Error: 0.318209, Training Accuracy: 17.70%
  Epoch 10: 500/3000 samples processed...
  Epoch 10: 1000/3000 samples processed...
  Epoch 10: 1500/3000 samples processed...
  Epoch 10: 2000/3000 samples processed...
  Epoch 10: 2500/3000 samples processed...
  Epoch 10: 3000/3000 samples processed...
‚úì Epoch 10/20, Average Error: 0.311283, Training Accuracy: 21.73%
  Epoch 11: 500/3000 samples processed...
  Epoch 11: 1000/3000 samples processed...
  Epoch 11: 1500/3000 samples processed...
  Epoch 11: 2000/3000 samples processed...
  Epoch 11: 2500/3000 samples processed...
  Epoch 11: 3000/3000 samples processed...
‚úì Epoch 11/20, Average Error: 0.302626, Training Accuracy: 25.37%
  Epoch 12: 500/3000 samples processed...
  Epoch 12: 1000/3000 samples processed...
  Epoch 12: 1500/3000 samples processed...
  Epoch 12: 2000/3000 samples processed...
  Epoch 12: 2500/3000 samples processed...
  Epoch 12: 3000/3000 samples processed...
‚úì Epoch 12/20, Average Error: 0.290377, Training Accuracy: 31.83%
  Epoch 13: 500/3000 samples processed...
  Epoch 13: 1000/3000 samples processed...
  Epoch 13: 1500/3000 samples processed...
  Epoch 13: 2000/3000 samples processed...
  Epoch 13: 2500/3000 samples processed...
  Epoch 13: 3000/3000 samples processed...
‚úì Epoch 13/20, Average Error: 0.277103, Training Accuracy: 34.30%
  Epoch 14: 500/3000 samples processed...
  Epoch 14: 1000/3000 samples processed...
  Epoch 14: 1500/3000 samples processed...
  Epoch 14: 2000/3000 samples processed...
  Epoch 14: 2500/3000 samples processed...
  Epoch 14: 3000/3000 samples processed...
‚úì Epoch 14/20, Average Error: 0.254691, Training Accuracy: 41.20%
  Epoch 15: 500/3000 samples processed...
  Epoch 15: 1000/3000 samples processed...
  Epoch 15: 1500/3000 samples processed...
  Epoch 15: 2000/3000 samples processed...
  Epoch 15: 2500/3000 samples processed...
  Epoch 15: 3000/3000 samples processed...
‚úì Epoch 15/20, Average Error: 0.226379, Training Accuracy: 51.07%
  Epoch 16: 500/3000 samples processed...
  Epoch 16: 1000/3000 samples processed...
  Epoch 16: 1500/3000 samples processed...
  Epoch 16: 2000/3000 samples processed...
  Epoch 16: 2500/3000 samples processed...
  Epoch 16: 3000/3000 samples processed...
‚úì Epoch 16/20, Average Error: 0.191189, Training Accuracy: 60.90%
  Epoch 17: 500/3000 samples processed...
  Epoch 17: 1000/3000 samples processed...
  Epoch 17: 1500/3000 samples processed...
  Epoch 17: 2000/3000 samples processed...
  Epoch 17: 2500/3000 samples processed...
  Epoch 17: 3000/3000 samples processed...
‚úì Epoch 17/20, Average Error: 0.144008, Training Accuracy: 76.17%
  Epoch 18: 500/3000 samples processed...
  Epoch 18: 1000/3000 samples processed...
  Epoch 18: 1500/3000 samples processed...
  Epoch 18: 2000/3000 samples processed...
  Epoch 18: 2500/3000 samples processed...
  Epoch 18: 3000/3000 samples processed...
‚úì Epoch 18/20, Average Error: 0.090442, Training Accuracy: 89.20%
  Epoch 19: 500/3000 samples processed...
  Epoch 19: 1000/3000 samples processed...
  Epoch 19: 1500/3000 samples processed...
  Epoch 19: 2000/3000 samples processed...
  Epoch 19: 2500/3000 samples processed...
  Epoch 19: 3000/3000 samples processed...
‚úì Epoch 19/20, Average Error: 0.045780, Training Accuracy: 97.10%
  Epoch 20: 500/3000 samples processed...
  Epoch 20: 1000/3000 samples processed...
  Epoch 20: 1500/3000 samples processed...
  Epoch 20: 2000/3000 samples processed...
  Epoch 20: 2500/3000 samples processed...
  Epoch 20: 3000/3000 samples processed...
‚úì Epoch 20/20, Average Error: 0.019455, Training Accuracy: 99.83%

üß™ Evaluating the network...
  Sample 0 - Prediction: 2, True: 2 ‚úì
  Sample 1 - Prediction: 3, True: 3 ‚úì
  Sample 2 - Prediction: 1, True: 1 ‚úì
  Sample 3 - Prediction: 9, True: 9 ‚úì
  Sample 4 - Prediction: 0, True: 0 ‚úì
  Sample 5 - Prediction: 8, True: 8 ‚úì
  Sample 6 - Prediction: 9, True: 9 ‚úì
  Sample 7 - Prediction: 9, True: 9 ‚úì
  Sample 8 - Prediction: 2, True: 2 ‚úì
  Sample 9 - Prediction: 8, True: 8 ‚úì
  Sample 10 - Prediction: 9, True: 9 ‚úì
  Sample 11 - Prediction: 2, True: 2 ‚úì
  Sample 12 - Prediction: 3, True: 3 ‚úì
  Sample 13 - Prediction: 9, True: 9 ‚úì
  Sample 14 - Prediction: 7, True: 7 ‚úì

üéØ Final Accuracy: 100.00% (200/200)
```